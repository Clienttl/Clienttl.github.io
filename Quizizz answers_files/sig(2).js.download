var p=Object.defineProperty,f=(m,q,n)=>q in m?p(m,q,{enumerable:!0,configurable:!0,writable:!0,value:n}):m[q]=n,h=(m,q,n)=>(f(m,"symbol"!=typeof q?q+"":q,n),n);
(function(){function m(a,b){window.sendEvent?window.sendEvent("fl_"+a,b):(D||=setInterval(q,100),z.push({event:a,extra:b}))}function q(){window.sendEvent&&(clearInterval(D),z.forEach(a=>{m(a.event,a.extra)}),z=[])}function n(a,b){m(u.Error,{error:{message:null!=b&&b.message?`${a} - ${b.message}`:a}})}function H(a,b){return atob(a).split("").map(c=>c.charCodeAt(0)).map(c=>String.fromCharCode(c^b)).join("")}function E(a,b,c=!1){if("string"!=typeof a&&(a=JSON.stringify(a)),a.startsWith("$$"))return b;
try{return JSON.parse(c?window.atob(a):a)}catch(d){return n("failed decoding config",d),b}}function v(a){return a.reduce((b,c)=>b+c,0)/a.length}function F(a){const b=v(a);return Math.sqrt(a.reduce((c,d)=>c+Math.pow(d-b,2),0)/a.length)}function I(a,b){return new Promise((c,d)=>{setTimeout(()=>{d(Error(b??`timeout ${a}`))},a)})}async function J(a,b,c){return Promise.race([a,I(b,c)])}function K(a){return new Promise(b=>setTimeout(b,a))}async function L(a,b,c){for(let e=0;e<c;e++){var d=performance.now();
await a();d=b-(performance.now()-d);e<c-1&&0<d&&await K(d)}}function M(a){if(0<Object.keys(a).length)return a;const b={};for(const c in a){const d=a[c];null!=d&&"function"!=typeof d&&(b[c]=a[c])}return b}function N(a,b){if(b.type===l.Static)return new O(a,b);if(b.type===l.Network)return new P(a,b);if(b.type===l.Element)return new Q(a,b);if(b.type===l.Mouse)return new R(a,b);throw Error(`invalid type ${b.type} in ${a}`);}var l=(a=>(a.Static="static",a.Network="network",a.Mouse="mouse",a.Element="element",
a))(l||{}),w=(a=>(a.Login="login",a.Ip="ip",a.Sensor="sensor",a))(w||{});l.Network;l.Static;l.Static;l.Static;l.Element;l.Mouse;w.Sensor;w.Ip;l.Network;w.Login;l.Static;l.Static;l.Static;l.Element;const S={version:1,collectors:{}};var u=(a=>(a.Signal="sig",a.Init="init",a.Error="error",a))(u||{});let z=[],D;class x{constructor(a,b){h(this,"config");h(this,"name");h(this,"eventListeners");this.config=b;this.name=a;this.eventListeners={};try{this.initialize()}catch(c){this.reportError("error initializing",
c)}"complete"!==document.readyState?window.addEventListener("load",()=>{try{this.ready()}catch(c){this.reportError("error invoking ready",c)}}):this.ready()}initialize(){}ready(){}report(a,b){m(u.Signal,{name:this.name,success:a,fail:b})}reportError(a,b){n(`${this.name}[${this.config.type}]: ${a}`,b)}addEventListener(a,b,c,d,e){let k=0;const g=r=>{try{b(r)}catch(t){this.reportError(`error in ${a}`,t),e&&this.removeEventListeners(d,a)}finally{k++,c&&k>=c&&this.removeEventListeners(d,a)}};window.addEventListener(a,
g,{capture:!0,passive:!0});this.eventListeners[a]=g}removeEventListeners(a=!0,b){a?Object.keys(this.eventListeners).forEach(c=>{this.removeEventListener(c)}):this.removeEventListener(b)}removeEventListener(a){if(a){var b=this.eventListeners[a];b&&(window.removeEventListener(a,b,{capture:!0}),delete this.eventListeners[a])}}}class Q extends x{constructor(a,b){super(a,b)}ready(){const a=this.config.elements;for(const [b,c]of Object.entries(a))this.createElement(b,c)}createElement(a,b){const {type:c,
parent:d,attributes:e,style:k}=b;b=this.getParentElement(null==d?void 0:d.selector);if(!b)return void n(`failed to find parent element with selector ${null==d?void 0:d.selector} for ${a}`);const g=document.createElement(c),r={position:"absolute",zIndex:"10",fontSize:"1px",opacity:"0.01",...k};g.id=a;Object.assign(g,e);Object.assign(g.style,r);g.addEventListener("click",this.onElementClick);this.insertElement(g,b,null==d?void 0:d.prepend)}insertElement(a,b,c){c?b.prepend(a):b.append(a)}getParentElement(a){return a?
document.querySelector(a):document.body}onElementClick(a){const b=a.target;b.style.pointerEvents="none";const c=document.elementFromPoint(a.clientX,a.clientY);if(b.style.pointerEvents="auto",c&&c!==b)a=new MouseEvent(a.type,a),c.dispatchEvent(a)}}class P extends x{constructor(a,b){super(a,b)}async ready(){const a={},b={};await Promise.all(Object.entries(this.config.entries).map(async([c,d])=>this.collect(c,d,a,b)));this.report(a,b)}async getFetchUrlDurationMs(a,b){const c=this.config.timeoutMs??5E3,
d=new AbortController,e=setTimeout(()=>d.abort(Error(`timeout ${c}`)),c),k=performance.now();await fetch(a,{mode:"no-cors",credentials:b?"omit":"include",referrerPolicy:"no-referrer",cache:"no-store",signal:d.signal});a=performance.now();return clearTimeout(e),Math.round(a-k)}async collect(a,b,c,d){const e=[];if(await L(async()=>{try{const g=await this.getFetchUrlDurationMs(b.url,b.noCredentials);e.push(g)}catch(g){this.addError(a,g,d)}},this.config.intervalMs??1E3,this.config.count??3),0!==e.length){var k=
1===e.length?e[0]:Math.round(v(e.slice(1)));c[a]={averageDurationMs:k,pingDurationsMs:e}}}addError(a,b,c){c[a]||(c[a]=[]);c[a].push(null==b?void 0:b.message)}}class R extends x{constructor(a,b){super(a,b);h(this,"eventsWindow");h(this,"minTimeDeltaMs");h(this,"minDistancePx");h(this,"velocityResolution");h(this,"angleResolution");h(this,"mouseDataArray");this.eventsWindow=this.config.eventsWindow??200;this.minTimeDeltaMs=this.config.minTimeDeltaMs??20;this.minDistancePx=this.config.minDistancePx??
10;this.velocityResolution=this.config.velocityResolution??5;this.angleResolution=this.config.angleResolution??6;this.mouseDataArray=[]}ready(){const a={x:0,y:0,timestampMs:0};this.addEventListener("mousemove",b=>this.onMouseMove(b,a),void 0,!0,!0);this.addEventListener("mousedown",b=>this.onMouseDown(b,a),this.config.maxReport,!0,!0)}onMouseMove(a,b){const c=a.clientX;a=a.clientY;const d=Math.abs(c-b.x),e=Math.abs(a-b.y),k=Date.now(),g=k-b.timestampMs;d<=this.minDistancePx&&e<=this.minDistancePx&&
g<this.minTimeDeltaMs||(b.x=c,b.y=a,b.timestampMs=k,this.mouseDataArray.length>=2*this.eventsWindow&&this.mouseDataArray.splice(0,this.eventsWindow),this.mouseDataArray.push({...b}))}onMouseDown(a,b){this.onMouseMove(a,b);this.calculateAndReport(this.mouseDataArray.slice(-this.eventsWindow));this.mouseDataArray.length=0}calculateAndReport(a){if(!(2>a.length)){var b={x:{countUnique:0,velocities:[]},y:{countUnique:0,velocities:[]}},c=b.x.velocities,d=b.y.velocities,e,k,g,r=0;for(let y=1;y<a.length;y++){const {velocityX:A,
velocityY:B,angle:G}=this.calculate(a[y],a[y-1]);(void 0===e||Math.abs(A-e)>=this.velocityResolution)&&(b.x.countUnique++,e=A);(void 0===k||Math.abs(B-k)>=this.velocityResolution)&&(b.y.countUnique++,k=B);c.push(A);d.push(B);var t=G,T=this.angleResolution,C;(C=void 0===g)||(t=Math.abs(t-g)%360,C=Math.min(360-t,t)>=T);C&&(r++,g=G)}this.reportSignals(a,b,r)}}calculate(a,b){const c=a.x-b.x,d=a.y-b.y;a=a.timestampMs-b.timestampMs;return{velocityX:1E3*c/a,velocityY:1E3*d/a,angle:180*Math.atan2(d,c)/Math.PI}}reportSignals(a,
b,c){const {velocities:d,countUnique:e}=b.x,{velocities:k,countUnique:g}=b.y;a={count:a.length,uniqueAngles:c,x:{average:Math.round(v(d)),std:Math.round(F(d)),countUnique:e},y:{average:Math.round(v(k)),std:Math.round(F(k)),countUnique:g},coordinates:{first:{x:a[0].x,y:a[0].y},last:{x:a[a.length-1].x,y:a[a.length-1].y}}};this.report(a)}}class O extends x{constructor(a,b){super(a,b)}initialize(){for(const [a,b]of Object.entries(this.config.eventParams))"load"!==a||"complete"!==document.readyState?this.addEventListener(a,
c=>{this.collect(a,b,c)},this.config.maxReport):this.collect(a,b)}async collectSingle(a,b){a=await eval(`async (e) => ${a}`)(b);return"object"==typeof a&&(a=M(a)),a}async collect(a,b,c){const d={},e={},k=this.config.timeoutMs??1E3;await Promise.all(Object.entries(b).map(async([g,r])=>{try{d[g]=await J(this.collectSingle(r,c),k)}catch(t){e[g]=`${r}: ${null==t?void 0:t.message}`}}));this.report(d,e)}}(function(){var a=234^E("67",234);const b=0!==a;let c="0ovKxsXFzMrdxtvai5PSi8TEi5PSi8jK3cDfzIuT3dvczIWLxMjR+8zZxtvdi5OchYvd0NnMi5OLxMbc2syL1IWLxMbc2syLk9KLyMrdwN/Mi5Pd29zMhYvM38zH3fnI28jE2ouT0ovKxcDKwouT0ovK0YuTi8yHysXAzMfd8YuFi8rQi5OLzIfKxcDMx93wi4WLwM2Lk4vMh93I287M3YfAzYnV1Yncx83Mz8DHzM2LhYvA2v3b3NrdzM2Lk4vMh8Da/dvc2t3MzYvUhYvExtzazNzZi5PSi8Tc0YuTi8yHysXAzMfd8YuFi8Tc0IuTi8yHysXAzMfd8IvUhYvdxtzKwdrdyNvdi5PSi8DNi5OLzIfdyNvOzN2HwM2J1dWJ3MfNzM/Ax8zNi4WL3drRi5OLzIfdxtzKwcza8pn0h8rFwMzH3fGLhYvd2tCLk4vMh93G3MrBzNrymfSHysXAzMfd8IvU1IWL3dDZzIuTi9rdyN3AyovUhYva3cjdi5PSi8jK3cDfzIuT3dvczIWLzN/Mx935yNvIxNqLk9KLxcbIzYuT0ovL282Lk4vewMfNxt6Hx8jfwM7I3cbbh9zazNvozszH3e3I3ciJj4+J3sDHzcbeh8fI38DOyN3G24fc2szb6M7Mx93tyN3Ih8vbyMfN2ouFi8rBwMeLk4vSysbH2t2J2NzG3cjlwMTA3ZTkyN3Bh9vG3MfNgYGB3sDHzcbeh9nM28/G28TIx8rMiY+PidnM28/G28TIx8rMh8TMxMbb0ImPj4nZzNvPxtvEyMfKzIfEzMTG29CHw9rhzMjZ+sDTzOXAxMDdgInV1YmYmZ6anp2YkZudgIn1homBmJmbnYmDiZiZm52AgImDiZuSicrGx9rdidjcxt3IlMjeyMDdicfM3on528bEwNrMgYHbzNrGxd/MhYnbzMPMyt2AlJfSx8jfwM7I3cbbh97My8LA3f3MxNnG28jb0PrdxtvIzsyH2NzM29D82sjOzOjHzfjcxt3IgYH2hYnY3MbdyICUl9LbzNrGxd/MgeTI3cGH28bcx82B2NzG3ciJ9YaJgZiZm52Jg4mYmZudgICAktSFiYHMgJSX0tvMw8zK3YHMgNSA1ICSidvM3dzbx4nY3MbdyImVidjcxt3I5cDEwN2Jj4+Jgdjcxt3IiZWJm5+RidXVidjcxt3IiZeJmpqQgJLUi4WLxcjHzouTi8fI38DOyN3G24fFyMfO3MjOzIuFi8XIx87ai5OLx8jfwM7I3cbbh8XIx87cyM7M2ouFi97Ni5OLx8jfwM7I3cbbh97My83bwN/M24vU1IWL3dDZzIuTi9rdyN3AyovUhYvezYuT0ovIyt3A38yLk93b3MyFi8zfzMfd+cjbyMTai5PSi8XGyM2Lk9KL3s2Lk4vHyN/AzsjdxtuH3szLzdvA38zbidXVidzHzczPwMfMzYvU1IWL3dDZzIuTi9rdyN3AyovU1IWL38zb2sDGx4uTmNQ=";a=(b&&(c=
H(c,a)),E(c,S,!b));for(const [d,e]of Object.entries(a.collectors))try{e.active&&N(d,e)}catch(k){n(`failed creating ${JSON.stringify(e)}`,k)}m(u.Init,{experiment:{"name":null}})})()})();
